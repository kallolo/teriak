<html>
  <head> </head>
  <style>
    .container {
      width: "100%";
      height: 100dvh;
      border: 3px solid #744b04;
      position: relative;
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      overflow: hidden;
    }
    h1 {
      font-size: 50px;
      margin-top: 50px;
      color: #744b04;
    }
    .icecream {
      width: 200px;
      display: block;
      margin: 35px auto;
    }
    .icecream.animate {
      animation: imageAnimation 4s;
    }
    @keyframes imageAnimation {
      0% {
        transform: scale(0.3);
      }
      50% {
        transform: scale(1.3);
      }
    }
    .decibelmeter {
      height: 0px;
      width: 500px;
      position: absolute;
      bottom: 0;
      background-color: #24110b;
      z-index: -1;
    }
    .start {
      padding: 4 8;
      font-size: 20px;
      background-color: #744b04;
      color: #fff;
    }
  </style>
  <body>
    <div class="container">
      <h1 class="scream">Teriak Berhadiah !</h1>
      <img src="goeboex1.png" class="icecream" alt="" />
      <div class="decibelmeter"></div>
      <button type="button" class="start">Mulai</button>
    </div>
    <script>
      var scream = document.querySelector(".scream");
      var icecream = document.querySelector(".icecream");
      var decibelmeter = document.querySelector(".decibelmeter");
      var start = document.querySelector(".start");

      start.addEventListener("click", function () {
        var audioContext = new AudioContext();
        var streamPromise = navigator.mediaDevices.getUserMedia({ audio: true });

        streamPromise.then(function (stream) {
          var microphone = audioContext.createMediaStreamSource(stream);
          var analyser = audioContext.createAnalyser();
          microphone.connect(analyser);

          var decibelInterval = setInterval(function () {
            var dataArray = new Uint8Array(analyser.frequencyBinCount);
            analyser.getByteFrequencyData(dataArray);

            var decibels = 0;
            for (var i = 0; i < dataArray.length; i++) {
              decibels += dataArray[i];
            }

            var level = 2; // you can adjust the level from 1.0 to 10.0
            decibels = (10 * decibels) / dataArray.length / level;
            decibelmeter.style.height = decibels + "px";

            if (decibels >= 600) {
              scream.style.color = "white";
              scream.innerHTML = "SELAMAT!, KAMU BERHASIL !!";
              icecream.classList.add("animate");
              clearInterval(decibelInterval);
            }
          }, 100);
        });
      });
    </script>
  </body>
</html>
